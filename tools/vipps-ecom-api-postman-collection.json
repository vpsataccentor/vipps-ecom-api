{
   "info":{
      "name":"MTE - eCommerce InApp Alignment API",
      "_postman_id":"cc06f7b1-738d-4dfb-9937-9218948186c2",
      "description":"",
      "schema":"https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
   },
   "item":[
      {
         "name":"Get Access Token",
         "event":[
            {
               "listen":"test",
               "script":{
                  "id":"e82847b6-91eb-4ce3-9fb5-8198d399ff0a",
                  "type":"text/javascript",
                  "exec":[
                     "pm.environment.set(\"Access_Token\", pm.response.json().access_token);"
                  ]
               }
            }
         ],
         "request":{
            "method":"POST",
            "header":[
               {
                  "key":"client_id",
                  "value":"{{Client_Id}}"
               },
               {
                  "key":"client_secret",
                  "value":"{{Client_Secret}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{AT_Ocp_Apim_Key}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":""
            },
            "url":{
               "raw":"https://apitest.vipps.no/accessToken/get",
               "protocol":"https",
               "host":[
                  "apitest",
                  "vipps",
                  "no"
               ],
               "path":[
                  "accessToken",
                  "get"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Initiate Payment",
         "event":[
            {
               "listen":"prerequest",
               "script":{
                  "id":"cf89fe57-fe5f-46c5-8c65-51781f99507a",
                  "type":"text/javascript",
                  "exec":[
                     "pm.environment.set('orderId',pm.environment.get('MSN') + (new Date()).getTime());",
                     "pm.environment.set('isoTime',(new Date()).toISOString());"
                  ]
               }
            },
            {
               "listen":"test",
               "script":{
                  "id":"e11b2030-35ab-4897-a42e-1bd771016b32",
                  "type":"text/javascript",
                  "exec":[
                     ""
                  ]
               }
            }
         ],
         "request":{
            "method":"POST",
            "header":[
               {
                  "key":"Content-Type",
                  "value":"application/json"
               },
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               },
               {
                  "key":"X-Request-Id",
                  "value":"{{$randomInt}}"
               },
               {
                  "key":"X-Source-Address",
                  "value":"{{$guid}}"
               },
               {
                  "key":"X-TimeStamp",
                  "value":"{{isoTime}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":"{\n  \"merchantInfo\": {\n    \"merchantSerialNumber\": \"{{MSN}}\",\n    \"callbackPrefix\":\"{{callBackUrl}}\",\n    \"fallBack\": \"{{fallBack}}\",\n    \"authToken\": \"{{$guid}}\",\n    \"isApp\":false\n  },\n    \n  \"customerInfo\": {\n    \"mobileNumber\": \"{{Customer_Mobile}}\"\n  },\n  \n  \"transaction\": {\n    \"orderId\": \"{{orderId}}\",\n    \"amount\": {{amount}},\n    \"transactionText\": \"{{TransactionTextInitiate}}\",\n    \"timeStamp\": \"{{isoTime}}\"\n  }\n}"
            },
            "url":{
               "raw":"{{URL_ROOT}}",
               "host":[
                  "{{URL_ROOT}}"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Get Order Status",
         "event":[
            {
               "listen":"prerequest",
               "script":{
                  "id":"28dcc2df-296c-4c0d-a05b-4e171230b6e1",
                  "type":"text/javascript",
                  "exec":[
                     "pm.environment.set('isoTime',(new Date()).toISOString());"
                  ]
               }
            }
         ],
         "request":{
            "method":"GET",
            "header":[
               {
                  "key":"Content-Type",
                  "value":"application/json"
               },
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               },
               {
                  "key":"X-Source-Address",
                  "value":"{{$guid}}"
               },
               {
                  "key":"X-TimeStamp",
                  "value":"{{isoTime}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":""
            },
            "url":{
               "raw":"{{URL_ROOT}}/{{orderId}}/status",
               "host":[
                  "{{URL_ROOT}}"
               ],
               "path":[
                  "{{orderId}}",
                  "status"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Capture Payment",
         "request":{
            "method":"POST",
            "header":[
               {
                  "key":"Content-Type",
                  "value":"application/json"
               },
               {
                  "key":"X-Request-Id",
                  "value":"{{$randomInt}}"
               },
               {
                  "key":"X-Source-Address",
                  "value":"{{$guid}}"
               },
               {
                  "key":"X-TimeStamp",
                  "value":"{{isoTime}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               },
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":" {\n    \"merchantInfo\": {\n        \"merchantSerialNumber\": \"{{MSN}}\"\n    },\n    \"transaction\": {\n        \"amount\": {{amount}},\n        \"transactionText\":\"{{TransactionTextCapture}} \"\n    }\n }"
            },
            "url":{
               "raw":"{{URL_ROOT}}/{{orderId}}/capture",
               "host":[
                  "{{URL_ROOT}}"
               ],
               "path":[
                  "{{orderId}}",
                  "capture"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Get Payment Details",
         "request":{
            "method":"GET",
            "header":[
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":""
            },
            "url":{
               "raw":"{{URL_ROOT}}/{{orderId}}/details",
               "host":[
                  "{{URL_ROOT}}"
               ],
               "path":[
                  "{{orderId}}",
                  "details"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Refund Payment",
         "request":{
            "method":"POST",
            "header":[
               {
                  "key":"Content-Type",
                  "value":"application/json"
               },
               {
                  "key":"X-Request-Id",
                  "value":"{{$randomInt}}"
               },
               {
                  "key":"X-Source-Address",
                  "value":"{{$guid}}"
               },
               {
                  "key":"X-TimeStamp",
                  "value":"{{isoTime}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               },
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":"{\r\n    \"merchantInfo\": {\r\n        \"merchantSerialNumber\": \"{{MSN}}\"\r\n    },\r\n    \"transaction\": {\r\n        \"transactionText\":\"{{TransactionTextRefund}}\"\r\n    }\r\n}"
            },
            "url":{
               "raw":"{{URL_ROOT}}/{{orderId}}/refund",
               "host":[
                  "{{URL_ROOT}}"
               ],
               "path":[
                  "{{orderId}}",
                  "refund"
               ]
            },
            "description":null
         },
         "response":[

         ]
      },
      {
         "name":"Cancel Payment",
         "request":{
            "method":"PUT",
            "header":[
               {
                  "key":"Content-Type",
                  "value":"application/json"
               },
               {
                  "key":"X-Source-Address",
                  "value":"{{$guid}}"
               },
               {
                  "key":"X-TimeStamp",
                  "value":"{{isoTime}}"
               },
               {
                  "key":"Ocp-Apim-Subscription-Key",
                  "value":"{{Ocp_Apim_Key}}"
               },
               {
                  "key":"Authorization",
                  "value":"Bearer {{Access_Token}}"
               }
            ],
            "body":{
               "mode":"raw",
               "raw":"{\r\n    \"merchantInfo\": {\r\n        \"merchantSerialNumber\": \"{{MSN}}\"\r\n    },\r\n    \"transaction\": {\r\n        \"transactionText\":\"{{TransactionTextCancel}}\"\r\n    }\r\n}"
            },
            "url":{
               "raw":"{{URL_ROOT}}/{{orderId}}/cancel",
               "host":[
                  "{{URL_ROOT}}"
               ],
               "path":[
                  "{{orderId}}",
                  "cancel"
               ]
            },
            "description":null
         },
         "response":[

         ]
      }
   ]
}
